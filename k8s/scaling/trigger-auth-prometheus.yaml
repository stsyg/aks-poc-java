# TriggerAuthentication for KEDA Prometheus scaler
# Uses Azure Workload Identity to authenticate to Azure Monitor Managed Prometheus.
# This is required for the Prometheus trigger in the visits-service ScaledObject.
#
# Prerequisites:
#   1. Workload Identity enabled on AKS (--enable-workload-identity --enable-oidc-issuer)
#   2. Azure Monitor Managed Prometheus configured (comes with monitoring add-on)
#   3. A Kubernetes ServiceAccount annotated with the managed identity client ID
#
# To configure:
#   1. Create a managed identity for KEDA prometheus access
#   2. Assign "Monitoring Reader" role on the Azure Monitor workspace
#   3. Create a federated credential linking the K8s ServiceAccount to the identity
#   4. Update the ServiceAccount name below
#
# This is provided as a template â€” uncomment and configure when ready to use
# the Prometheus-based scaling trigger.
# ---
# apiVersion: keda.sh/v1alpha1
# kind: TriggerAuthentication
# metadata:
#   name: azure-managed-prometheus-auth
#   namespace: petclinic
# spec:
#   podIdentity:
#     provider: azure-workload
#     identityId: "${KEDA_IDENTITY_CLIENT_ID}"
